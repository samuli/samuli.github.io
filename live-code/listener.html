<!doctype html>
<html lang="en">

<head id="head">
  <meta charset="utf-8">
</head>

<body id="body">
  <script type="text/javascript">
    window.addEventListener("message", (e) => {
      if (e.data.cmd && e.data.cmd === "html") {
        e.source.postMessage(document.documentElement.outerHTML, "*");
        return;
      }

      if (e.data.head) {
       document.getElementById("head").innerHTML = e.data.head;

       Array.from(document.getElementById('head').getElementsByTagName("script")).forEach(function (s) {
         if (s.attributes && s.attributes.src) {
           var scriptTag = document.createElement("script");
           scriptTag.setAttribute("src", s.attributes.src.nodeValue);
           scriptTag.setAttribute("type", "text/javascript");
           document.getElementById("head").appendChild(scriptTag);
           s.remove();
         }
       });
     }
     if (e.data.body) {
       document.getElementById("body").innerHTML = e.data.body;
     }
     if (e.data.script) {
       var s = document.getElementById("__app__");
       if (s) {
         s.remove();
       }

       var scriptTag = document.createElement("script");
       scriptTag.setAttribute("id", "__app__");

       var el = document.createTextNode(e.data.script);
       scriptTag.appendChild(el);
       document.getElementById("head").appendChild(scriptTag);
     }
   });
  </script>

  <div id="content"></div>

</body>

</html>
